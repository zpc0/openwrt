// SPDX-License-Identifier: GPL-2.0-or-later OR MIT
// Author: Yanase Yuki <dev@zpc.st>
/dts-v1/;
#include "mt7988a.dtsi"
#include <dt-bindings/input/input.h>
#include <dt-bindings/leds/common.h>
#include <dt-bindings/regulator/richtek,rt5190a-regulator.h>

/ {
	model = "TP-Link BE805 v1.20";
	compatible = "tplink,be805-v1.20", "mediatek,mt7988a";
	chassis-type = "embedded";

	aliases {
		serial0 = &serial0;
	};

	chosen {
		bootargs = "";
		stdout-path = "serial0:115200n8";
	};

	memory {
		device_type = "memory";
		reg = <0x0 0x40000000>;
	};
};

&pio {
	i2c0_pins: i2c0-pins {
		mux {
			function = "i2c";
			groups = "i2c0_1";
		};
	};

	spi0_pins: spi0-pins {
		mux {
			function = "spi";
			groups = "spi0_wp_hold", "spi0";
		};
	};
};

&serial0 {
	status = "okay";
};

&i2c0 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&i2c0_pins>;
};

&spi0 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&spi0_pins>;

	flash: flash@0 {
		compatible = "spi-nand";
		reg = <0>;

		// half of the max rating (104 MHz)
		spi-max-frequency = <52000000>;
		spi-rx-bus-width = <4>;
		spi-tx-bus-width = <4>;

		nand-ecc-engine = <&flash>;

		// use stock firmware's value
		spi-cal-enable;
		spi-cal-mode = "read-data";
		spi-cal-datalen = <7>;
		spi-cal-data = [53 50 49 4e 41 4e 44];
		spi-cal-addrlen = <5>;
		spi-cal-addr = <0x0 0x0 0x0 0x0 0x0>;
	};
};

&gmac1 {
	status = "okay";
};

&gmac2 {
	status = "okay";
};

&flash {
	partitions {
		compatible = "fixed-partitions";
		#address-cells = <1>;
		#size-cells = <1>;

		partition@0 {
			reg = <0x0 0x200000>;
			label = "boot";
			read-only;
		};

		partition@200000 {
			reg = <0x200000 0x100000>;
			label = "u-boot-env";
		};

		partition@300000 {
			reg = <0x300000 0x3200000>;
			label = "ubi";
			read-only;
		};

		partition@3500000 {
			reg = <0x3500000 0x3200000>;
			label = "ubi1";
			read-only;
		};

		partition@6700000 {
			reg = <0x6700000 0x800000>;
			label = "userconfig";
			read-only;
		};

		partition@6f00000 {
			reg = <0x6f00000 0x800000>;
			label = "tp_data";
			read-only;
		};
	};
};

